import numpy as np
import matplotlib.pyplot as plt

from scipy.fftpack import fft
# Dados da elevação da superfície livre em metros
elevacao = [
0.001,
0.019,
0.038,
0.058,
0.077,
0.097,
0.116,
0.134,
0.154,
0.168,
0.183,
0.196,
0.208,
0.217,
0.224,
0.229,
0.232,
0.231,
0.229,
0.223,
0.215,
0.205,
0.192,
0.176,
0.159,
0.139,
0.118,
0.095,
0.072,
0.047,
0.021,
-0.005,
-0.031,
-0.056,
-0.081,
-0.105,
-0.128,
-0.150,
-0.169,
-0.187,
-0.202,
-0.215,
-0.226,
-0.233,
-0.238,
-0.240,
-0.239,
-0.236,
-0.229,
-0.220,
-0.209,
-0.194,
-0.178,
-0.160,
-0.140,
-0.118,
-0.095,
-0.072,
-0.047,
-0.023,
0.002,
0.027,
0.050,
0.073,
0.095,
0.116,
0.135,
0.152,
0.167,
0.180,
0.190,
0.198,
0.204,
0.207,
0.208,
0.206,
0.202,
0.196,
0.187,
0.177,
0.164,
0.150,
0.135,
0.118,
0.100,
0.081,
0.061,
0.041,
0.021,
0.000,
-0.019,
-0.038,
-0.057,
-0.075,
-0.092,
-0.107,
-0.122,
-0.135,
-0.146,
-0.156,
-0.165,
-0.172,
-0.177,
-0.181,
-0.183,
-0.184,
-0.183,
-0.181,
-0.178,
-0.173,
-0.168,
-0.161,
-0.153,
-0.144,
-0.135,
-0.125,
-0.114,
-0.103,
-0.091,
-0.079,
-0.067,
-0.054,
-0.041,
-0.028,
-0.015,
-0.001,
0.013,
0.027,
0.040,
0.055,
0.069,
0.083,
0.097,
0.112,
0.126,
0.140,
0.155,
0.169,
0.183,
0.197,
0.210,
0.224,
0.236,
0.248,
0.260,
0.270,
0.279,
0.288,
0.295,
0.300,
0.305,
0.307,
0.308,
0.306,
0.303,
0.297,
0.289,
0.279,
0.266,
0.251,
0.234,
0.214,
0.191,
0.167,
0.140,
0.111,
0.080,
0.047,
0.012,
-0.024,
-0.061,
-0.099,
-0.137,
-0.176,
-0.215,
-0.254,
-0.292,
-0.329,
-0.365,
-0.400,
-0.432,
-0.462,
-0.490,
-0.515,
-0.537,
-0.555,
-0.570,
-0.581,
-0.589,
-0.592,
-0.592,
-0.587,
-0.578,
-0.565,
-0.548,
-0.527,
-0.502,
-0.474,
-0.442,
-0.406,
-0.368,
-0.327,
-0.283,
-0.238,
-0.190,
-0.142,
-0.092,
-0.041,
0.010,
0.061,
0.111,
0.161,
0.209,
0.256,
0.301,
0.344,
0.385,
0.422,
0.457,
0.489,
0.517,
0.542,
0.564,
0.581,
0.595,
0.605,
0.611,
0.614,
0.613,
0.608,
0.599,
0.587,
0.572,
0.554,
0.533,
0.509,
0.483,
0.455,
0.425,
0.393,
0.359,
0.325,
0.289,
0.253,
0.217,
0.180,
0.143,
0.107,
0.071,
0.036,
0.002,
-0.031,
-0.063,
-0.093,
-0.122,
-0.149,
-0.174,
-0.198,
-0.219,
-0.239,
-0.256,
-0.272,
-0.285,
-0.297,
-0.306,
-0.314,
-0.319,
-0.323,
-0.325,
-0.325,
-0.324,
-0.321,
-0.317,
-0.312,
-0.306,
-0.299,
-0.290,
-0.281,
-0.272,
-0.262,
-0.251,
-0.241,
-0.230,
-0.219,
-0.208,
-0.197,
-0.187,
-0.176,
-0.166,
-0.157,
-0.148,
-0.139,
-0.131,
-0.123,
-0.116,
-0.109,
-0.103,
-0.097,
-0.092,
-0.087,
-0.082,
-0.078,
-0.073,
-0.069,
-0.065,
-0.061,
-0.057,
-0.053,
-0.048,
-0.043,
-0.038,
-0.033,
-0.027,
-0.021,
-0.014,
-0.007,
0.000,
0.008,
0.017,
0.026,
0.035,
0.045,
0.055,
0.065,
0.076,
0.086,
0.097,
0.107,
0.117,
0.127,
0.137,
0.146,
0.156,
0.163,
0.170,
0.176,
0.182,
0.186,
0.190,
0.193,
0.194,
0.195,
0.194,
0.193,
0.190,
0.187,
0.182,
0.177,
0.171,
0.165,
0.157,
0.150,
0.142,
0.134,
0.126,
0.118,
0.110,
0.103,
0.096,
0.090,
0.084,
0.080,
0.076,
0.073,
0.071,
0.069,
0.069,
0.071,
0.073,
0.076,
0.079,
0.084,
0.089,
0.095,
0.102,
0.108,
0.115,
0.121,
0.128,
0.134,
0.139,
0.143,
0.147,
0.149,
0.149,
0.148,
0.145,
0.141,
0.134,
0.125,
0.114,
0.101,
0.086,
0.068,
0.048,
0.026,
0.002,
-0.024,
-0.051,
-0.081,
-0.111,
-0.143,
-0.176,
-0.209,
-0.242,
-0.276,
-0.309,
-0.341,
-0.373,
-0.403,
-0.431,
-0.458,
-0.482,
-0.504,
-0.523,
-0.539,
-0.552,
-0.561,
-0.567,
-0.569,
-0.567,
-0.562,
-0.552,
-0.539,
-0.522,
-0.501,
-0.477,
-0.449,
-0.419,
-0.385,
-0.349,
-0.310,
-0.269,
-0.227,
-0.183,
-0.138,
-0.092,
-0.045,
0.001,
0.047,
0.092,
0.136,
0.179,
0.221,
0.260,
0.298,
0.333,
0.365,
0.395,
0.442,
0.446,
0.467,
0.485,
0.500,
0.512,
0.521,
0.526,
0.529,
0.529,
0.527,
0.522,
0.514,
0.505,
0.490,
0.480,
0.465,
0.449,
0.432,
0.414,
0.394,
0.375,
0.354,
0.334,
0.313,
0.292,
0.271,
0.251,
0.230,
0.210,
0.190,
0.170,
0.151,
0.132,
0.114,
0.096,
0.078,
0.060,
0.043,
0.025,
0.008,
-0.009,
-0.026,
-0.043,
-0.060,
-0.077,
-0.095,
-0.112,
-0.130,
-0.148,
-0.165,
-0.183,
-0.201,
-0.219,
-0.237,
-0.255,
-0.273,
-0.290,
-0.307,
-0.324,
-0.339,
-0.355,
-0.369,
-0.383,
-0.396,
-0.407,
-0.418,
-0.427,
-0.434,
-0.441,
-0.445,
-0.448,
-0.450,
-0.449,
-0.447,
-0.443,
-0.438,
-0.430,
-0.421,
-0.410,
-0.397,
-0.383,
-0.366,
-0.348,
-0.329,
-0.308,
-0.286,
-0.262,
-0.237,
-0.210,
-0.183,
-0.155,
-0.126,
-0.096,
-0.065,
-0.034,
-0.002,
0.030,
0.062,
0.095,
0.127,
0.159,
0.192,
0.223,
0.255,
0.286,
0.316,
0.345,
0.374,
0.401,
0.427,
0.452,
0.476,
0.497,
0.518,
0.536,
0.522,
0.566,
0.579,
0.588,
0.596,
0.600,
0.602,
0.602,
0.598,
0.592,
0.583,
0.571,
0.556,
0.538,
0.517,
0.493,
0.467,
0.437,
0.406,
0.371,
0.335,
0.296,
0.255,
0.212,
0.168,
0.123,
0.077,
0.029,
-0.018,
-0.066,
-0.114,
-0.161,
-0.208,
-0.253,
-0.298,
-0.340,
-0.381,
-0.420,
-0.456,
-0.490,
-0.521,
-0.549,
-0.574,
-0.596,
-0.614,
-0.629,
-0.640,
-0.647,
-0.652,
-0.652,
-0.649,
-0.643,
-0.634,
-0.621,
-0.606,
-0.587,
-0.566,
-0.543,
-0.518,
-0.490,
-0.461,
-0.431,
-0.399,
-0.366,
-0.330,
-0.299,
-0.264,
-0.230,
-0.196,
-0.161,
-0.128,
-0.095,
-0.062,
-0.030,
0.000,
0.030,
0.059,
0.087,
0.114,
0.140,
0.165,
0.189,
0.212,
0.235,
0.256,
0.277,
0.297,
0.316,
0.335,
0.353,
0.371,
0.388,
0.404,
0.420,
0.436,
0.451,
0.465,
0.479,
0.492,
0.504,
0.515,
0.525,
0.540,
0.541,
0.547,
0.552,
0.554,
0.555,
0.553,
0.549,
0.543,
0.534,
0.523,
0.509,
0.492,
0.472,
0.449,
0.423,
0.394,
0.363,
0.328,
0.291,
0.252,
0.210,
0.165,
0.119,
0.071,
0.022,
-0.028,
-0.079,
-0.131,
-0.183,
-0.234,
-0.285,
-0.335,
-0.383,
-0.430,
-0.474,
-0.517,
-0.556,
-0.592,
-0.625,
-0.654,
-0.679,
-0.700,
-0.717,
-0.729,
-0.737,
-0.740,
-0.738,
-0.732,
-0.721,
-0.706,
-0.686,
-0.662,
-0.635,
-0.603,
-0.568,
-0.530,
-0.489,
-0.445,
-0.399,
-0.352,
-0.303,
-0.253,
-0.202,
-0.151,
-0.101,
-0.050,
-0.001,
0.047,
0.094,
0.139,
0.181,
0.222,
0.259,
0.294,
0.326,
0.354,
0.379,
0.401,
0.420,
0.435,
0.447,
0.455,
0.460,
0.462,
0.461,
0.457,
0.450,
0.440,
0.428,
0.414,
0.398,
0.381,
0.362,
0.341,
0.320,
0.297,
0.275,
0.251,
0.228,
0.205,
0.182,
0.159,
0.137,
0.116,
0.096,
0.077,
0.058,
0.041,
0.025,
0.011,
-0.003,
-0.015,
-0.026,
-0.035,
-0.043,
-0.050,
-0.056,
-0.061,
-0.065,
-0.068,
-0.070,
-0.071,
-0.071,
-0.071,
-0.071,
-0.070,
-0.068,
-0.067,
-0.065,
-0.063,
-0.062,
-0.060,
-0.059,
-0.058,
-0.057,
-0.056,
-0.056,
-0.056,
-0.056,
-0.057,
-0.058,
-0.059,
-0.061,
-0.063,
-0.065,
-0.067,
-0.070,
-0.073,
-0.076,
-0.079,
-0.081,
-0.084,
-0.087,
-0.089,
-0.091,
-0.093,
-0.094,
-0.095,
-0.095,
-0.095,
-0.095,
-0.094,
-0.092,
-0.089,
-0.086,
-0.083,
-0.078,
-0.074,
-0.068,
-0.062,
-0.056,
-0.049,
-0.042,
-0.035,
-0.027,
-0.019,
-0.011,
-0.003,
0.005,
0.013,
0.020,
0.028,
0.035,
0.042,
0.048,
0.053,
0.058,
0.063,
0.066,
0.069,
0.072,
0.073,
0.074,
0.074,
0.074,
0.072,
0.070,
0.068,
0.064,
0.061,
0.056,
0.052,
0.047,
0.042,
0.036,
0.031,
0.025,
0.020,
0.014,
0.009,
0.004,
-0.001,
-0.006,
-0.010,
-0.013,
-0.017,
-0.020,
-0.022,
-0.025,
-0.027,
-0.028,
-0.029,
-0.031,
-0.031,
-0.032,
-0.033,
-0.034,
-0.034,
-0.035,
-0.036,
-0.038,
-0.040,
-0.042,
-0.044,
-0.048,
-0.051,
-0.055,
-0.060,
-0.065,
-0.071,
-0.077,
-0.083,
-0.090,
-0.096,
-0.103,
-0.110,
-0.117,
-0.123,
-0.129,
-0.134,
-0.139,
-0.143,
-0.145,
-0.146,
-0.146,
-0.145,
-0.141,
-0.136,
-0.129,
-0.120,
-0.109,
-0.096,
-0.080,
-0.063,
-0.044,
-0.022,
0.001,
0.026,
0.053,
0.081,
0.110,
0.140,
0.171,
0.202,
0.233,
0.264,
0.294,
0.324,
0.352,
0.379,
0.404,
0.427,
0.447,
0.464,
0.479,
0.490,
0.497,
0.501,
0.501,
0.496,
0.488,
0.476,
0.459,
0.439,
0.415,
0.387,
0.355,
0.320,
0.282,
0.241,
0.198,
0.153,
0.106,
0.058,
0.009,
-0.041,
-0.090,
-0.139,
-0.187,
-0.233,
-0.278,
-0.320,
-0.360,
-0.397,
-0.431,
-0.461,
-0.487,
-0.510,
-0.528,
-0.543,
-0.553,
-0.559,
-0.561,
-0.558,
-0.552,
-0.542,
-0.529,
-0.512,
-0.492,
-0.470,
-0.445,
-0.419,
-0.390,
-0.361,
-0.331,
-0.300,
-0.269,
-0.238,
-0.208,
-0.179,
-0.152,
-0.125,
-0.101,
-0.078,
-0.057,
-0.039,
-0.023,
-0.009,
0.003,
0.012,
0.020,
0.025,
0.029,
0.030,
0.031,
0.030,
0.028,
0.026,
0.023,
0.020,
0.017,
0.015,
0.014,
0.013,
0.014,
0.016,
0.019,
0.025,
0.032,
0.041,
0.053,
0.066,
0.081,
0.098,
0.117,
0.138,
0.160,
0.184,
0.209,
0.234,
0.260,
0.287,
0.313,
0.339,
0.365,
0.389,
0.413,
0.435,
0.455,
0.473,
0.488,
0.502,
0.512,
0.520,
0.525,
0.527,
0.526,
0.522,
0.515,
0.505,
0.492,
0.476,
0.458,
0.438,
0.415,
0.390,
0.364,
0.336,
0.306,
0.276,
0.245,
0.213,
0.182,
0.150,
0.118,
0.087,
0.056,
0.025,
-0.005,
-0.033,
-0.062,
-0.089,
-0.115,
-0.141,
-0.166,
-0.190,
-0.213,
-0.236,
-0.259,
-0.281,
-0.303,
-0.325,
-0.347,
-0.370,
-0.393,
-0.416,
-0.440,
-0.464,
-0.488,
-0.514,
-0.539,
-0.565,
-0.591,
-0.617,
-0.643,
-0.669,
-0.694,
-0.718,
-0.740,
-0.761,
-0.780,
-0.797,
-0.811,
-0.821,
-0.828,
-0.831,
-0.830,
-0.824,
-0.813,
-0.797,
-0.775,
-0.748,
-0.714,
-0.675,
-0.629,
-0.578,
-0.520,
-0.457,
-0.389,
-0.315,
-0.236,
-0.153,
-0.066,
0.025,
0.118,
0.213,
0.310,
0.408,
0.505,
0.601,
0.696,
0.788,
0.877,
0.961,
1.041,
1.115,
1.182,
1.243,
1.296,
1.340,
1.376,
1.403,
1.420,
1.427,
1.425,
1.413,
1.391,
1.359,
1.317,
1.266,
1.206,
1.138,
1.062,
0.979,
0.889,
0.793,
0.692,
0.587,
0.479,
0.368,
0.255,
0.142,
0.029,
-0.083,
-0.192,
-0.299,
-0.402,
-0.501,
-0.594,
-0.682,
-0.763,
-0.838,
-0.905,
-0.964,
-1.016,
-1.059,
-1.093,
-1.120,
-1.138,
-1.148,
-1.149,
-1.143,
-1.129,
-1.109,
-1.081,
-1.047,
-1.007,
-0.963,
-0.913,
-0.859,
-0.802,
-0.742,
-0.680,
-0.616,
-0.551,
-0.485,
-0.419,
-0.354,
-0.289,
-0.226,
-0.165,
-0.106,
-0.049,
0.005,
0.056,
0.105,
0.150,
0.191,
0.230,
0.265,
0.296,
0.325,
0.350,
0.372,
0.391,
0.407,
0.421,
0.432,
0.440,
0.447,
0.451,
0.454,
0.455,
0.454,
0.452,
0.449,
0.445,
0.439,
0.433,
0.426,
0.418,
0.410,
0.401,
0.391,
0.380,
0.369,
0.357,
0.345,
0.332,
0.318,
0.304,
0.289,
0.273,
0.257,
0.240,
0.222,
0.203,
0.184,
0.164,
0.143,
0.122,
0.101,
0.079,
0.056,
0.034,
0.011,
-0.012,
-0.035,
-0.057,
-0.080,
-0.102,
-0.123,
-0.144,
-0.164,
-0.184,
-0.202,
-0.219,
-0.236,
-0.251,
-0.264,
-0.277,
-0.288,
-0.297,
-0.305,
-0.312,
-0.317,
-0.320,
-0.322,
-0.323,
-0.322,
-0.319,
-0.315,
-0.310,
-0.303,
-0.295,
-0.286,
-0.276,
-0.264,
-0.252,
-0.238,
-0.223,
-0.208,
-0.191,
-0.174,
-0.156,
-0.137,
-0.118,
-0.098,
-0.078,
-0.057,
-0.035,
-0.013,
0.009,
0.013,
0.053,
0.076,
0.099,
0.121,
0.144,
0.166,
0.187,
0.208,
0.229,
0.249,
0.267,
0.285,
0.302,
0.317,
0.310,
0.343,
0.353,
0.361,
0.368,
0.372,
0.374,
0.373,
0.370,
0.364,
0.356,
0.346,
0.332,
0.316,
0.297,
0.276,
0.252,
0.226,
0.198,
0.168,
0.136,
0.102,
0.066,
0.030,
-0.007,
-0.046,
-0.084,
-0.122,
-0.161,
-0.198,
-0.235,
-0.270,
-0.304,
-0.336,
-0.366,
-0.394,
-0.419,
-0.441,
-0.460,
-0.475,
-0.488,
-0.496,
-0.501,
-0.502,
-0.500,
-0.493,
-0.483,
-0.470,
-0.452,
-0.432,
-0.408,
-0.381,
-0.351,
-0.319,
-0.285,
-0.248,
-0.210,
-0.171,
-0.130,
-0.089,
-0.047,
-0.005,
0.036,
0.077,
0.117,
0.156,
0.193,
0.229,
0.263,
0.295,
0.324,
0.351,
0.375,
0.397,
0.416,
0.432,
0.445,
0.455,
0.463,
0.468,
0.469,
0.469,
0.465,
0.460,
0.451,
0.441,
0.429,
0.415,
0.399,
0.381,
0.362,
0.342,
0.320,
0.298,
0.274,
0.250,
0.225,
0.200,
0.174,
0.148,
0.122,
0.096,
0.069,
0.043,
0.017,
-0.010,
]

elevacao = np.array(elevacao)
tempo = np.arange(1, 1443, 1)
# Cálculo da Altura Significativa
altura_significativa = np.sqrt(np.mean(elevacao**2))

print("Altura Significativa:", altura_significativa)

# Cálculo do Período Significativo
# Aplicando a FFT para encontrar a frequência dominante
fft_resultado = np.fft.fft(elevacao)
frequencias = np.fft.fftfreq(len(fft_resultado))
indice_frequencia_max = np.argmax(np.abs(fft_resultado[1:])) + 1  # Ignorando a componente de frequência zero
frequencia_max = frequencias[indice_frequencia_max]
periodo_max = 1 / frequencia_max

print("Período Significativo:", periodo_max)

# Visualização da série temporal
plt.plot(tempo, elevacao)
plt.title('Série Temporal da Elevação da Superfície Livre')
plt.xlabel('Tempo (s)')
# Calcule a Transformada Rápida de Fourier
fft_result = fft(elevacao)

# Calcule as frequências correspondentes
# O fator 1/(N*dt) é necessário para obter frequências em Hz
dt = tempo[1] - tempo[0]
frequencies = np.fft.fftfreq(len(fft_result), dt)
positive_frequencies = frequencies[:len(frequencies)//2]

# Encontre o índice da frequência dominante (exceto a componente contínua)
dominant_index = np.argmax(np.abs(fft_result[1:len(positive_frequencies)+1]))

# Calcule o período da onda dominante
dominant_period = 1 / positive_frequencies[dominant_index]

# Calcule a altura média da onda
altura_media = np.mean(np.abs(elevacao))

# Exiba os resultados
print(f"Período Médio: {dominant_period} segundos")
print(f"Altura Média: {altura_media} metros")

# Resto do seu código de plotagem
plt.plot(tempo, elevacao)
plt.show()
# Calcule a altura máxima da onda
altura_maxima = np.max(np.abs(elevacao))

# Calcule o índice da frequência correspondente à onda de maior amplitude (exceto a componente contínua)
frequencia_maxima = positive_frequencies[np.argmax(np.abs(fft_result[1:len(positive_frequencies)+1]))]

# Calcule o período correspondente à onda de maior amplitude
periodo_maximo = 1 / frequencia_maxima

# Exiba os resultados
print(f"Altura Máxima: {altura_maxima} metros")
print(f"Período Máximo: {periodo_maximo} segundos")

# Resto do seu código de plotagem
plt.plot(tempo, elevacao)
plt.show()
# Calcule a altura média quadrática (RMS)
altura_rms = np.sqrt(np.mean(elevacao**2))

# Exiba o resultado
print(f"Altura Média Quadrática: {altura_rms} metros")

# Resto do seu código de plotagem
plt.plot(tempo, elevacao)
plt.show()
import numpy as np

# Altura média quadrática (RMS) já calculada
altura_rms = np.sqrt(np.mean(elevacao**2))

# Altura de onda para a qual você deseja calcular a probabilidade de excedência
h = 0.8

# Probabilidade de excedência usando a distribuição de Rayleigh
prob_excedencia = np.exp(-h**2 / (2 * altura_rms**2))

# Exiba o resultado
print(f"Probabilidade de excedência para H = {h} m: {prob_excedencia:.4f}")

# Resto do seu código
# ...

